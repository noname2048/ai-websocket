# ai-fastapi
09 번째 프로젝트. 웹소켓 사용해서 채팅 띄우기

## 목표
1. fastapi, flask 중 선택하여 웹소켓을 가동하는 공통 채팅 서버 띄우기
2. pure python 혹은 간단한 library를 이용하여 해당 서버와 소통하기
3. 소켓과 웹소켓의 차이점을 이해하기. 혹은 소켓으로 웹소켓 접속하기
4. UDP 신호를 웹소켓으로 실시간으로 전달하기 (iot -> udp -> server -> ws)

## 아키텍처 설계 가설 (2가지)
1. 센서에 tcp, ws를 열어 web client 단에서 js로 직접 통신한다.
2. 센서는 udp send만 한다.수집은 따로 UDP 서버가 해서 데이터를 정리한다.

1번은 web client가 소규모 일때 (유저수가 매우 적을때) 혹은, 세부 모니터링 방식에 적합하다.
그러나 나는 이런 센서가 매우 여러개 있을 수 있다고 가정한다. 따라서 2번을 선택하겠다.

## 아키텍처 확정
- 센서 (TCP로 서버A에 UDP 전달할 주소를 얻어온다.). UDP 발송만 진행한다.
- UDP 데이터 수집 서버(pure python socket). 물론 로그도 남기고, 어떤 센서가 작동중인지도 저장한다.
- redis (cache DB)
- 서버A. fastapi 웹앱. (센서가 HTTP(s)로 주소를 물어본다.) ws 연결시 갱신되는 데이터를 쏜다.

## UDP간 송수신
- 누군가가 악의적으로 잘못된 데이터를 전달 할 수 있다.
- 내부 해킹이 일어나지 않는다고 가정했을때, 아주 기본적인 보안조치로 JWT를 사용하겠다.
- 센서(UDP+JWT) => 데이터수집서버(pure python)

## 데이터 수집서버로 fastapi나 flask를 이용하지 않는 이유
- 그들은 데이터 웹데이터 혹은 ws 처리에 익숙하거나 좋다.
- socket을 열려면 구조를 약간 뒤틀어야 하는데, 보기 좋지 않고, 커스터마이징(기타 로직 삽입)이 어렵다.

## 데이터 수집 방법
- redis
- mongodb
- rdbms
- file(csv)

file과 rdbms를 선택하기로 했다. 기기가 여러개라면 기기 고유의 코드를 가지고 있어야한다. 만약 특정기기의 하루치 값이 필요하다고 한다면, RDB 이상으로 유지보수가 좋아보이는건 없어보인다. 다만 1개일 때는 단순히 file로 읽고, 값을 메모리에 가지고 있다가, csv에 이어쓰기를 하는것이 좋아보인다.
